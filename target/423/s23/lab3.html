<h2> CSE 423 Lab #3: Bison </h2>

Turnin: part 1 on Canvas in a single .zip file. This includes your answers to
questions 1-12 along with your
makefile and .l/.y/.c files except not the files generated by flex and bison.

<p>

<h4> 0. Preliminaries </h4>

If you haven't already, read the required Bison reading (sections 1 and 3-6
of the <A href="https://www.gnu.org/software/bison/manual/">GNU Bison
Manual</A>). If that's not enough, read the Bison chapters of the optional
text (Flex and Bison) or the other optional text (Build Your Own Programming
Language).

<h4>1. Bison Basics </h4>

Download (or copy paste) the following toy Flex and Bison specifications.

<p>

<table border><tr><th>Flex <A href="nnws.l">nnws.l</A> <th>Bison <A href="ns.y">ns.y</A>
<tr><td>
<pre>
%option noyywrap
<!--#include "ns.tab.h"
-->%%
[a-zA-Z]+ { return NAME; }
[0-9]+ { return NUMBER; }
[ \t\n]+ { }
. { fprintf(stderr, "bad char\n"); }
</pre>
<td>
<pre>
%token NAME NUMBER
%%
sequence : pair sequence | ;
pair : NAME NUMBER { printf("got a name-number pair\n"); } ;
</pre>
</table>

<ol>
<li> When you run <code>flex nnws.l</code>, what output file
      does flex write?
<li> When you run <code>gcc -c lex.yy.c</code>, what do you get?
<li> When you run <code>bison ns.y</code>, what output file
      does Bison write?
<li> Devise a command line for compiling the bison output to a .o file.
     Fix warnings by added extern prototypes for yylex() and yyerror().
<li> When you run <code>bison -d ns.y</code>, what header file does Bison
     generate?
<li> Add <code>#include "ns.tab.h"</code> to the header section of nnws.l.
     Such C code goes inside %{ ... %} marks.
     Re-run flex nnws.l and rerun gcc -c lex.yy.c
<li> Write a third module, main.c, that initializes <code>yyin</code>
     by opening whatever filename is given in argv[1]
     and then calls <code>yyparse()</code> and prints out the yyparse()
     return value to standard output with a message such as
     <code>yyparse returns 0</code>.
<li> Add a yyerror() function to main.c:
     <pre>
int yyerror(char *s) {
   fprintf(stderr, "%s\n", s); exit(1);
}</pre>
<li> Compile your main.c to main.o with <code>gcc -c main.c</code>
<li> Devise a command line for linking the lex and bison output .o files
     with main.o to make
     an executable named <code>ns</code> (short for "name sequence")
<li> Run your program on itself with <code>./ns nnws.l</code>. What does
     it write out?
<li> Run your program on an input file
     (you can name this file whatever you want) containing
<pre>
DrJ 1 Evil 0
</pre>

What does it write out?
</ol>

<h4>2. Bison your HW#3 Away</h4>

You can save the "build a syntax tree"
part for later, but if you complete this lab, you should have your Flex
homework wired up to a Python-subset grammar. When it is running, you have
a syntax checker for the PunY language.

<ol>
<li> Create a new lab3/ subdirectory.
<li> Download
<A href="http://www.cs.nmt.edu/~jeffery/courses/423/punygram.y.html">Punygram.y</A>,
 an adaptation of Python's Grammar. At present, almost the entire grammar is
 commented out. You probably should work by moving one line at a time from the
 grammar comment up into the Bison grammar section, at least
 until you get a feel for what you are doing.  The start symbol for your
 Bison grammar should probably be non-terminal <code>file_input</code>.

<li> Edit punygram.y until it is complete and in legal Bison format.
     You should include all grammar rules, unless you know for a
     fact that they cannot occur because one of their required lexical
     elements (tokens) will generate a lexical error that halts execution.

<li> Copy in punylex.l flex specification from HW#2.
<li> Modify punylex.l and punygram.y until they have the same set of TERMINAL
     symbol names.  Maybe this means renaming everything in one or the other.
     Note: punygram.y has a lot of terminal symbols. It might be missing some
     or you might be missing some.
     Note that single-character operators and punctuation use their ASCII
     code as their terminal symbol code.
<li> Run bison -d on punygram.y to make a punygram.tab.h.
<li> Modify your punylex.l to #include punygram.tab.h instead of whatever
     previous terminal symbol definitions it used in HW#2.
<li> Modify your HW2 main() function to call yyparse() one time
     in place of the while
     loop that called yylex() over and over again.
<li> Test your program (now a syntax checker) on both valid PunY inputs
     like a "hello world" program, as well as on some inputs with syntax errors.
</ol>
